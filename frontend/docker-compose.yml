services:
  frontend:
    build:
      context: .
      dockerfile: Dockerfile
    container_name: hospitalerp-frontend
    env_file:
      - .env
    environment:
      - NGINX_HOST=localhost
      - NGINX_PORT=80
      # These can be set via .env file or runtime environment
      - API_URL=${API_URL:-http://localhost:5037}
      - KEYCLOAK_URL=${KEYCLOAK_URL:-http://localhost:8080}
      - KEYCLOAK_REALM=${KEYCLOAK_REALM:-hospital-erp}
      - KEYCLOAK_CLIENT_ID=${KEYCLOAK_CLIENT_ID:-hospital-frontend}
    ports:
      - "${FRONTEND_PORT:-4200}:80"
    volumes:
      # Optional: mount nginx config for customization
      # - ./nginx.conf:/etc/nginx/conf.d/default.conf:ro
      # Optional: mount built files for development
      # - ./dist/frontend/browser:/usr/share/nginx/html:ro
    networks:
      - frontend-network
    healthcheck:
      test: ["CMD-SHELL", "curl -f http://localhost:80/health || exit 1"]
      interval: 30s
      timeout: 10s
      retries: 3
      start_period: 10s
    restart: unless-stopped

networks:
  frontend-network:
    driver: bridge

